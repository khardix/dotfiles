- defaults:
    link:
      create: True  # Create parent directories if necessary
      relink: True  # Re-point broken links to the dotfiles dir

# Remove broken symlinks from the specified directories
- clean:
  - '~/.config'
  - '~'

- shell:
  - description: Update configuration sub-modules to latest master commit.
    stderr: True
    command: >
      git submodule --quiet foreach 'echo $path' | grep -v _tools/
      | xargs git submodule update --init --remote --merge --recursive

- link:
    ~/.config/i3:
    ~/.config/i3status:

    ~/.config/dunst/dunstrc: dunstrc

    ~/.config/git/config: gitconfig

    ~/.mpdscribble/mpdscribble.conf: mpdscribble/mpdscribble.conf

    ~/.config/mpv/config:
      force: true
      path: mpv/config

    ~/.psqlrc: psqlrc
    ~/.taskrc:
      path: taskwarrior/taskrc
      force: true
    ~/.tmux.conf:
      path: tmux/tmux.conf
      force: true

    ~/.config/udiskie: udiskie/
    ~/.config/systemd/user/udiskie.service: udiskie/udiskie.service

    ~/.config/ranger: ranger/
    ~/.config/feh: feh/

    ~/.XCompose: XCompose
    ~/.config/redshift.conf: redshift.conf

    ~/.latexmkrc: latexmkrc
    ~/.pandoc/templates: pandoc/templates

    ~/.config/systemd/user/jupyter.service: systemd/jupyter.service

    ~/.config/fontconfig:
        path: fonts
        force: true

    ~/.pypirc: pypirc
    ~/.config/flake8: flake8
